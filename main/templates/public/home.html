{% load static sass_tags %}
<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Global English - Mở ra thế giới với ngôn ngữ toàn cầu</title>

    <!-- Fonts & Libs -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/cdn.min.js"></script>

    <!-- SCSS -->
    <link rel="stylesheet" href="{% sass_src 'public/scss/home.scss' %}" />
  </head>

  <body>
    <!-- NAV -->
    <nav class="navbar navbar-expand-lg site-nav" aria-label="Điều hướng chính">
      <div class="container">
        <a class="navbar-brand" href="#hero">Global English</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Mở menu">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="mainNav">
          <ul class="navbar-nav ms-auto align-items-lg-center">
            {% for link in nav_links %}
              <li class="nav-item"><a class="nav-link" href="{{ link.href }}">{{ link.label }}</a></li>
            {% endfor %}
          </ul>
          <a class="btn btn-light btn-sm rounded-pill ms-lg-3 mt-3 mt-lg-0" href="{% url 'main:login' %}">Đăng nhập</a>
        </div>
      </div>
    </nav>

    <!-- HERO -->
    <header id="hero" class="hero" x-data="{ loaded: false }" x-init="setTimeout(() => (loaded = true), 100)">
      <div class="hero__background"></div>

      <div class="container position-relative">
        <div class="row align-items-center">
          <div class="col-lg-6">
            <div class="hero__content">
              <p class="hero__eyebrow text-uppercase small fw-semibold mb-3">{{ hero_setting.eyebrow }}</p>
              <h1 class="hero__title display-4 fw-bold mb-4"
                  x-data="{ text: '{{ hero_setting.typed_text|escapejs }}', displayedText: '', index: 0 }"
                  x-init="setTimeout(() => {
                    const i = setInterval(() => {
                      if ($data.index < $data.text.length) {
                        $data.displayedText += $data.text[$data.index]; $data.index += 1;
                      } else { clearInterval(i); }
                    }, 90);
                  }, 400)">
                <span x-text="displayedText"></span><span class="hero__cursor">|</span>
              </h1>
              <p class="hero__subtitle lead mb-4">{{ hero_setting.subtitle }}</p>
              <div class="d-flex flex-wrap gap-3">
                <a class="btn btn-light btn-lg rounded-pill px-4 hero__cta" href="{{ hero_setting.primary_cta_href }}">
                  <i class="fas fa-headset me-2"></i> {{ hero_setting.primary_cta_label }}
                </a>
                {% if hero_setting.secondary_cta_label %}
                <a class="btn btn-outline-light btn-lg rounded-pill px-4" href="{{ hero_setting.secondary_cta_href }}">
                  <i class="fas fa-play-circle me-2"></i> {{ hero_setting.secondary_cta_label }}
                </a>
                {% endif %}
              </div>
            </div>
          </div>
          <div class="col-lg-6 d-none d-lg-block">
            <aside class="hero__highlights">
              {% for highlight in hero_highlights %}
              <article class="floating-card">
                <span class="floating-card__icon"><i class="{{ highlight.icon }}"></i></span>
                <div>
                  <h3 class="h5 mb-2">{{ highlight.title }}</h3>
                  <p class="mb-0 text-white-50">{{ highlight.description }}</p>
                </div>
              </article>
              {% endfor %}
            </aside>
          </div>
        </div>
      </div>
    </header>

    <main>
      <!-- FEATURES (giữ nguyên) -->
      <section class="features" id="features">
        <div class="container">
          <div class="text-center mb-5">
            <h2 class="section-title">Vì sao học viên chọn Global English?</h2>
            <p class="section-subtitle">Kết hợp phương pháp sư phạm chuyên sâu với trải nghiệm học tập công nghệ cao.</p>
          </div>
          <div id="reasonsCarousel" class="carousel slide carousel-multi" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner">
              {% if reasons %}
                {% for feature in reasons %}
                  {% if forloop.first or forloop.counter0|divisibleby:3 %}
                  <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="row g-4 justify-content-center">
                  {% endif %}
                      <div class="col-md-4">
                        <article class="feature-card animate-on-scroll">
                          <div class="feature-card__media">
                            <img src="{{ feature.image_url }}" alt="{{ feature.title }}" class="feature-card__media-image" loading="lazy" />
                          </div>
                          <h3 class="feature-card__title">{{ feature.title }}</h3>
                          <p class="feature-card__body">{{ feature.description }}</p>
                        </article>
                      </div>
                  {% if forloop.counter|divisibleby:3 or forloop.last %}
                    </div>
                  </div>
                  {% endif %}
                {% endfor %}
              {% else %}
                <div class="carousel-item active">
                  <div class="row justify-content-center">
                    <div class="col-md-6 text-center text-muted py-4">Nội dung đang được cập nhật.</div>
                  </div>
                </div>
              {% endif %}
            </div>
            {% if reasons|length > 3 %}
              <button class="carousel-control-prev" type="button" data-bs-target="#reasonsCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Trước</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#reasonsCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Sau</span>
              </button>
            {% endif %}
          </div>
        </div>
      </section>

      <section class="courses" id="courses">
        <div class="container">
          <div class="text-center mb-5">
            <h2 class="section-title">Chương trình nổi bật</h2>
            <p class="section-subtitle">Lựa chọn khóa học phù hợp với mục tiêu và trình độ của bạn.</p>
          </div>

          <div id="coursesCarousel" class="carousel slide carousel-multi" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner">
              {% if courses %}
                {% for course in courses %}
                  {% if forloop.first or forloop.counter0|divisibleby:3 %}
                  <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="row g-4">
                  {% endif %}
                      <div class="col-md-4">
                        <article class="course-card animate-on-scroll">
                          <div class="course-card__visual"><i class="{{ course.icon }}"></i></div>
                          <div class="course-card__body">
                            <h3 class="course-card__title">{{ course.title }}</h3>
                            <p class="course-card__description">{{ course.description }}</p>
                            <div class="course-card__meta">
                              <span><i class="far fa-clock me-1"></i> {{ course.duration }}</span>
                              <span><i class="fas fa-user-friends me-1"></i> {{ course.level }}</span>
                            </div>
                          </div>
                        </article>
                      </div>
                  {% if forloop.counter|divisibleby:3 or forloop.last %}
                    </div>
                  </div>
                  {% endif %}
                {% endfor %}
              {% else %}
                <div class="carousel-item active">
                  <div class="row justify-content-center">
                    <div class="col-md-8 text-center text-muted py-4">Chương trình đang được cập nhật.</div>
                  </div>
                </div>
              {% endif %}
            </div>
            {% if courses|length > 3 %}
              <button class="carousel-control-prev" type="button" data-bs-target="#coursesCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Trước</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#coursesCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Sau</span>
              </button>
            {% endif %}
          </div>
        </div>
      </section>

      

      <!-- TEACHERS (giữ nguyên) -->
      <section class="teachers" id="teachers">
        <div class="container">
            <div class="text-center mb-5">
            <h2 class="section-title">Đội ngũ giảng viên</h2>
            <p class="section-subtitle">Đồng hành cùng giáo viên bản ngữ, chứng nhận quốc tế.</p>
            </div>

            <div id="teachersCarousel" class="carousel slide carousel-multi" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner">
                {% if teachers %}
                {% for teacher in teachers %}
                    {% if forloop.first or forloop.counter0|divisibleby:3 %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="row g-4">
                    {% endif %}

                        <div class="col-md-6 col-lg-4">
                        <!-- NEW structure: giống graduates -->
                        <article class="teacher-card animate-on-scroll" tabindex="0" aria-label="Giảng viên {{ teacher.name }}">
                            <div class="teacher-media">
                            <img src="{{ teacher.avatar_url }}" alt="{{ teacher.name }}" class="teacher-img" loading="lazy" />
                            <!-- Tên luôn hiển thị khi chưa hover -->
                            <div class="teacher-name-pill"><span class="name">{{ teacher.name }}</span></div>

                            <!-- Overlay + panel trượt lên khi hover/tap -->
                            <div class="teacher-overlay" aria-hidden="true">
                                <div class="teacher-panel">
                                <h3 class="name">{{ teacher.name }}</h3>
                                <p class="meta">
                                    {% if teacher.role %}<span class="role">{{ teacher.role }}</span>{% endif %}
                                    {% if teacher.experience_years %}
                                    <span class="dot">•</span><span class="exp">{{ teacher.experience_years }} năm kinh nghiệm</span>
                                    {% endif %}
                                </p>
                                {% if teacher.bio %}
                                    <p class="bio">{{ teacher.bio }}</p>
                                {% endif %}
                                </div>
                            </div>
                            </div>
                        </article>
                        </div>

                    {% if forloop.counter|divisibleby:3 or forloop.last %}
                    </div>
                    </div>
                    {% endif %}
                {% endfor %}
                {% else %}
                <div class="carousel-item active">
                    <div class="row justify-content-center">
                    <div class="col-md-8 text-center text-muted py-4">Thông tin giảng viên đang được cập nhật.</div>
                    </div>
                </div>
                {% endif %}
            </div>

            {% if teachers|length > 3 %}
                <button class="carousel-control-prev" type="button" data-bs-target="#teachersCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Trước</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#teachersCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Sau</span>
                </button>
            {% endif %}
            </div>
        </div>
        </section>


      
      <!-- ======= GRADUATES ======= -->
      <section class="graduates" id="graduates">
        <div class="container">
          <div class="text-center mb-5">
            <h2 class="section-title">Học viên tốt nghiệp xuất sắc</h2>
          </div>
          {% if graduates %}
          <div id="graduatesCarousel" class="carousel slide carousel-multi" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner">
              {% for graduate in graduates %}
                {% if forloop.first or forloop.counter0|divisibleby:3 %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                  <div class="row g-4">
                {% endif %}
                    <div class="col-sm-6 col-lg-4">
                      <article class="graduate-card animate-on-scroll" tabindex="0" aria-label="Học viên {{ graduate.name }}">
                        <div class="graduate-media">
                          <img src="{{ graduate.photo_url }}" alt="{{ graduate.name }}" class="graduate-img" loading="lazy" />
                          <div class="graduate-name-pill"><span class="name">{{ graduate.name }}</span></div>
                          <div class="graduate-overlay" aria-hidden="true">
                            <div class="graduate-panel">
                              <h3 class="name">{{ graduate.name }}</h3>
                              <p class="meta">
                                <span class="course">{{ graduate.course }}</span>
                                {% if graduate.score %}<span class="dot">&bull;</span><span class="score">{{ graduate.score }}</span>{% endif %}
                              </p>
                              {% if graduate.testimonial %}
                              <p class="quote">&ldquo;{{ graduate.testimonial }}&rdquo;</p>
                              {% endif %}
                            </div>
                          </div>
                        </div>
                      </article>
                    </div>
                {% if forloop.counter|divisibleby:3 or forloop.last %}
                  </div>
                </div>
                {% endif %}
              {% endfor %}
            </div>
            {% if graduates|length > 3 %}
            <button class="carousel-control-prev" type="button" data-bs-target="#graduatesCarousel" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Trước</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#graduatesCarousel" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Sau</span>
            </button>
            {% endif %}
          </div>
          {% else %}
          <div class="row g-4 justify-content-center">
            <div class="col-md-6 text-center text-muted py-4">Danh sách học viên xuất sắc đang được cập nhật.</div>
          </div>
          {% endif %}
        </div>
      </section>

      

<!-- TESTIMONIALS + ADVISORY (giữ nguyên) -->
      <section class="testimonials" id="testimonials">
        <div class="container">
          <div class="text-center mb-5">
            <h2 class="section-title">Câu chuyện thành công</h2>
            <p class="section-subtitle">Nghe học viên chia sẻ trải nghiệm thực tế sau khóa học.</p>
          </div>

          <div id="testimonialsCarousel" class="carousel slide carousel-multi" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner">
              {% if testimonials %}
                {% for testimonial in testimonials %}
                  {% if forloop.first or forloop.counter0|divisibleby:3 %}
                  <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="row g-4">
                  {% endif %}
                      <div class="col-md-4">
                        <article class="testimonial-card animate-on-scroll">
                          <p class="testimonial-card__quote">{{ testimonial.quote }}</p>
                          <div class="testimonial-card__author">
                            <span class="testimonial-card__avatar">{{ testimonial.initials }}</span>
                            <div>
                              <p class="h6 mb-1">{{ testimonial.name }}</p>
                              <p class="mb-0 text-muted">{{ testimonial.program }}</p>
                            </div>
                          </div>
                        </article>
                      </div>
                  {% if forloop.counter|divisibleby:3 or forloop.last %}
                    </div>
                  </div>
                  {% endif %}
                {% endfor %}
              {% else %}
                <div class="carousel-item active">
                  <div class="row justify-content-center">
                    <div class="col-md-8 text-center text-muted py-4">Chúng tôi sẽ cập nhật cảm nhận của học viên trong thời gian tới.</div>
                  </div>
                </div>
              {% endif %}
            </div>
            {% if testimonials|length > 3 %}
              <button class="carousel-control-prev" type="button" data-bs-target="#testimonialsCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Trước</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#testimonialsCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Sau</span>
              </button>
            {% endif %}
          </div>
        </div>
      </section>

      
      <section class="achievements" id="achievements">
        <div class="container">
          <div class="text-center mb-5">
            <h2 class="section-title">Thành tựu nổi bật</h2>
            <p class="section-subtitle">
              Những cột mốc, giải thưởng và hợp tác tiêu biểu minh chứng cho chất lượng đào tạo tại Global English.
            </p>
          </div>
          {% if achievements %}
          <div id="achievementsCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="6000">
            <div class="carousel-inner">
              {% for achievement in achievements %}
              <div class="carousel-item {% if forloop.first %}active{% endif %}">
                <article class="achievement-hero-card">
                  <div class="achievement-hero-card__media">
                    <img src="{{ achievement.image_url }}" alt="{{ achievement.image_alt|default:achievement.title }}" loading="lazy" />
                    {% if achievement.year %}<span class="achievement-hero-card__badge">{{ achievement.year }}</span>{% endif %}
                  </div>
                  <div class="achievement-hero-card__body">
                    <span class="achievement-hero-card__kind">{{ achievement.kind }}</span>
                    <h3 class="achievement-hero-card__title">{{ achievement.title }}</h3>
                    {% if achievement.subtitle %}<p class="achievement-hero-card__subtitle">{{ achievement.subtitle }}</p>{% endif %}
                    {% if achievement.description %}<p class="achievement-hero-card__description">{{ achievement.description }}</p>{% endif %}
                    {% if achievement.has_metric %}
                    <div class="achievement-hero-card__metric">
                      <span class="achievement-hero-card__metric-value">{{ achievement.metric_display }}</span>
                      <span class="achievement-hero-card__metric-label">Chỉ số nổi bật</span>
                    </div>
                    {% endif %}
                    {% if achievement.external_url %}
                    <a class="achievement-hero-card__link" href="{{ achievement.external_url }}" target="_blank" rel="noopener">
                      Tìm hiểu thêm <i class="fas fa-arrow-right ms-2"></i>
                    </a>
                    {% endif %}
                  </div>
                </article>
              </div>
              {% endfor %}
            </div>
            {% if achievements|length > 1 %}
            <button class="carousel-control-prev" type="button" data-bs-target="#achievementsCarousel" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Trước</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#achievementsCarousel" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Sau</span>
            </button>
            {% endif %}
          </div>
          {% else %}
          <div class="row g-4 justify-content-center">
            <div class="col-md-6 text-center text-muted py-4">Danh sách thành tựu đang được cập nhật.</div>
          </div>
          {% endif %}
        </div>
      </section>

      <section class="advisory" id="advisory">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-lg-8">
              <div class="advisory-card">
                <h2 class="advisory-title text-center">Cần tư vấn lộ trình học phù hợp?</h2>
                <p class="advisory-subtitle text-center">Nhập thông tin, đội ngũ tư vấn sẽ liên hệ sớm nhất.</p>
                <form class="row g-3" hx-post="/api/advisory" hx-target="#advisory-response" hx-swap="innerHTML">
                  <div class="col-md-6">
                    <label for="adv-name" class="form-label">Họ và tên</label>
                    <input id="adv-name" class="form-control form-control-lg" placeholder="Nguyễn Văn A" required />
                  </div>
                  <div class="col-md-6">
                    <label for="adv-phone" class="form-label">Số điện thoại</label>
                    <input id="adv-phone" type="tel" class="form-control form-control-lg" placeholder="09xx xxx xxx" required />
                  </div>
                  <div class="col-md-6">
                    <label for="adv-email" class="form-label">Email</label>
                    <input id="adv-email" type="email" class="form-control form-control-lg" placeholder="ban@example.com" required />
                  </div>
                  <div class="col-md-6">
                    <label for="adv-goal" class="form-label">Mục tiêu</label>
                    <select id="adv-goal" class="form-select form-select-lg" required>
                      <option value="">Chọn mục tiêu</option>
                      <option value="communication">Cải thiện giao tiếp</option>
                      <option value="business">Tiếng Anh công việc</option>
                      <option value="ielts">Luyện thi IELTS</option>
                      <option value="kids">Khóa học thiếu nhi</option>
                    </select>
                  </div>
                  <div class="col-12">
                    <label for="adv-message" class="form-label">Nhu cầu cụ thể</label>
                    <textarea id="adv-message" class="form-control" rows="4" placeholder="Chia sẻ thêm về kỳ vọng hoặc thời gian học của bạn..."></textarea>
                  </div>
                  <div class="col-12">
                    <button type="submit" class="btn btn-primary btn-lg w-100 rounded-pill">
                      <i class="fas fa-paper-plane me-2"></i> Gửi yêu cầu tư vấn
                    </button>
                  </div>
                </form>
                <div id="advisory-response" class="mt-3 text-center"></div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- FOOTER -->
    <footer class="site-footer">
      <div class="container">
        <div class="row gy-4">
          <div class="col-lg-4">
            <h3 class="site-footer__title">Global English</h3>
            <p class="site-footer__text">Trung tâm đào tạo tiếng Anh toàn diện.</p>
            <nav class="site-footer__social" aria-label="Kênh mạng xã hội">
              <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
              <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
              <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
              <a href="#" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
            </nav>
          </div>
          <div class="col-6 col-lg-2">
            <h4 class="site-footer__column-title">Chương trình</h4>
            <ul class="site-footer__links list-unstyled">
              {% for item in footer_programs %}<li><a href="{{ item.href }}">{{ item.label }}</a></li>{% endfor %}
            </ul>
          </div>
          <div class="col-6 col-lg-2">
            <h4 class="site-footer__column-title">Về chúng tôi</h4>
            <ul class="site-footer__links list-unstyled">
              {% for item in footer_about %}<li><a href="{{ item.href }}">{{ item.label }}</a></li>{% endfor %}
            </ul>
          </div>
          <div class="col-lg-4">
            <h4 class="site-footer__column-title">Liên hệ</h4>
            <ul class="site-footer__info list-unstyled">
              <li><i class="fas fa-map-marker-alt me-2"></i>123 Nguyễn Văn Linh, Quận 7, TP.HCM</li>
              <li><i class="fas fa-phone me-2"></i>(028) 1234 5678</li>
              <li><i class="fas fa-envelope me-2"></i>info@globalenglish.edu.vn</li>
            </ul>
          </div>
        </div>
        <hr class="site-footer__divider" />
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-center">
          <p class="mb-2 mb-md-0">© {{ now|date:"Y" }} Global English. All rights reserved.</p>
          <p class="mb-0">Phát triển vì cộng đồng học tiếng Anh.</p>
        </div>
      </div>
    </footer>

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'public/js/home.js' %}"></script>
  </body>
</html>
